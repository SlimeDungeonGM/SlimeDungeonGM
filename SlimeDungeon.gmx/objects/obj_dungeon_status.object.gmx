<!--This Document is generated by GameMaker, if you edit it by hand then you do so at your own risk!-->
<object>
  <spriteName>&lt;undefined&gt;</spriteName>
  <solid>0</solid>
  <visible>-1</visible>
  <depth>0</depth>
  <persistent>-1</persistent>
  <parentName>&lt;undefined&gt;</parentName>
  <maskName>&lt;undefined&gt;</maskName>
  <events>
    <event eventtype="0" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>/// @description Setup some base dungeon status
// You can write your code in this editor
/// initialize the player stats
if(instance_number(obj_dungeon_status) &gt; 1) instance_destroy();

name = "unknown";
race = "unknown";
born_gender = "unknown";
age = 0;
hp = 100;
maxhp = hp;
stamina = 100;
maxstamina = stamina;
expr = 0;
maxexpr = 3;
level = 1;
attack = 10;
defense = 100;
magicattack = 10;
magicdefense = 100;
threatlevel = "E";

//dungeon stats
dp = 1000;
maxdp = 1000;

b_dp_regan = true;
dp_regan = 1;
dp_regan_time = room_speed;


//creates the ds_map for each of the inventories of the dungeon
global.dm_creatures = ds_map_create();
global.dm_inventory = ds_map_create();
global.dm_abilities = ds_map_create();
global.dm_skills = noone;
global.dm_knowledges = ds_map_create(); 
global.dm_map = ds_map_create();

//creaturetexts[0] = "None";


//draw_set_font(defaultfont);
draw_set_font(fnt_HUD);
draw_set_colour(c_white);

//dungeon_ui = scr_dungeon_wave_hud;
//dungeon_mode = scr_dungeon_wave_state;

dungeon_ui = scr_dungeon_survival_hud;
dungeon_mode = scr_dungeon_survival_state;

toggle_camera = true;

//wave control variables
creature_count = 0;
creature_deathcount = 0;
creature_maxcount = 3;
bstop_spawn = false;

next_wave_time = 5;//delay the wave
start_wave = true;
start_next_wave = false;
wave_count = 0;
wave_maxcount = 2;

bfinish_wave = false;
reset_wave = false;

//Placement of size of dungeon floor.
globalvar dung_floor_size;
dung_floor_size[0] = 100;
dung_floor_size[1] = 100;

//Stores the map of the current floor.


//help text
helpkeys[0] = "Dungeon Keys";
helpkeys[1] = "Tab Key | Camera Toggle";
helpkeys[2] = "B | Build Menu";
helpkeys[3] = "Q | Status Menu";
helpkeys[4] = "F2 | Debug Menu";
helpkeys[5] = "Mouse Wheel | Zome Camera";
helpkeys[6] = "Mouse Middle | Pan Camera";
helpkeys[7] = "";
helpkeys[8] = "Command Mode";
helpkeys[9] = "Left Mouse | Select Select Unit";
helpkeys[10] = "Right Mouse | Move Unit";


//setup tests!
scr_init_skills();
scr_init_items();
scr_init_research();
scr_init_creatures();

</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="2" enumb="11">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>/// @description dungeon recovery points
// You can write your code in this editor
dp+=dp_regan;
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="2" enumb="2">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>/// @description update creatures list
// You can write your code in this editor

scr_getcreaturescount();
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="2" enumb="1">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>///wave check?
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="2" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>/// stamina regan alarm
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="3" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>/// control the stats
//if(hp &lt; 0){
//    hp = 0;
//}

//stamina regen
//if( stamina &lt; maxstamina &amp;&amp; alarm[0] == -1){
//    stamina++;
//}

if(b_dp_regan){
    if(alarm[11] &lt;= 0){
        alarm[11] = dp_regan_time;
    }
}

//dungeon reset
if(reset_wave){    
    hp = 5;
    maxhp = hp;
    stamina = 10;
    maxstamina = stamina;
    expr = 0;
    maxexpr = 3;
    level = 1;
    attack = 1;    
    //wave reset
    creature_count = 0;
    creature_deathcount = 0;
    creature_maxcount = 3;
    bstop_spawn = false;
    
    next_wave_time = 5;//delay the wave
    start_wave = true;
    start_next_wave = false;
    wave_count = 0;
    wave_maxcount = 2;
    reset_wave = false;
}

//pause the game
if(obj_input.dungeonmenu_key){
    if(instance_exists(obj_dungeon_menu)){
        if(obj_dungeon_menu.bdisplay){
            obj_dungeon_menu.bdisplay = false;
        }else{
            obj_dungeon_menu.bdisplay = true;
        }
    }
}

if(obj_input.f2_key){
    //scr_getcreatures();
    if(alarm[0] &lt;= 0){
        if(instance_exists(obj_admin)){
            if(obj_admin.bshow){
                obj_admin.bshow = false;
            }else{
                obj_admin.bshow = true;
            }
        }
        alarm[0] = room_speed / 6;
    }
}

if(obj_input.help_key){
    	bhelpkey = true;
}else{
    	bhelpkey = false;
}


//make sure game dungeon game mode is set to it.
script_execute(dungeon_mode);
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="7" enumb="4">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>/// remember the player's start position
//if(room == rm_pause) exit;

//switch(room_start_action){
//    case RETURN:
//        break;
//    case NEW_ROOM:
//    default:
        //if(instance_exists(obj_player)){
            //player_xstart = obj_player.x;
            //player_ystart = obj_player.y;
        //}
//        break;
//    case LOAD:
//        scr_load_game();
//        break;
//}
//room_persistent = false;
//room_start_action = NEW_ROOM;

scr_getcreaturescount();
scr_getadventurercount();

</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="8" enumb="64">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>/// @description Draw HUD

//Fix when player death and presistent draw.
if(global._ishud){
    if(global._display_dungeon){
        //script_execute(scr_dungeon_hud);
        script_execute(dungeon_ui);
    }
}

if(bhelpkey){
    script_execute(scr_display_help_key);
}
</string>
          </argument>
        </arguments>
      </action>
    </event>
  </events>
  <PhysicsObject>0</PhysicsObject>
  <PhysicsObjectSensor>0</PhysicsObjectSensor>
  <PhysicsObjectShape>0</PhysicsObjectShape>
  <PhysicsObjectDensity>0.5</PhysicsObjectDensity>
  <PhysicsObjectRestitution>0.100000001490116</PhysicsObjectRestitution>
  <PhysicsObjectGroup>0</PhysicsObjectGroup>
  <PhysicsObjectLinearDamping>0.100000001490116</PhysicsObjectLinearDamping>
  <PhysicsObjectAngularDamping>0.100000001490116</PhysicsObjectAngularDamping>
  <PhysicsObjectFriction>0.200000002980232</PhysicsObjectFriction>
  <PhysicsObjectAwake>-1</PhysicsObjectAwake>
  <PhysicsObjectKinematic>0</PhysicsObjectKinematic>
  <PhysicsShapePoints/>
</object>
